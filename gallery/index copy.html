<head>
    <!-- Add these preload directives for critical images (first few visible images) -->
    <link rel="preload" as="image" href="SB/1.JPG">
    <link rel="preload" as="image" href="SB/2.JPG">
    
    <style>
        /* Add this to your existing CSS */
        .blur-load {
            background-size: cover;
            background-position: center;
        }
        
        .blur-load.loaded > img {
            opacity: 1;
        }
        
        .blur-load > img {
            opacity: 0;
            transition: opacity 200ms ease-in-out;
        }
    </style>
</head>

<!-- Update the image sections with optimized loading -->
<div class="gallery-container" id="gallery">
    <!-- First visible images load eagerly -->
    <img src="SB/1.JPG" alt="Santa Barbara 1" 
         loading="eager" 
         fetchpriority="high" 
         decoding="async">
    <img src="SB/2.JPG" alt="Santa Barbara 2" 
         loading="eager" 
         fetchpriority="high" 
         decoding="async">
    <img src="SB/3.JPG" alt="Santa Barbara 3" 
         loading="eager" 
         decoding="async">
    <!-- Rest of images load lazily -->
    <img src="SB/4.JPG" alt="Santa Barbara 4" 
         loading="lazy" 
         decoding="async">
    <img src="SB/5.JPG" alt="Santa Barbara 5" 
         loading="lazy" 
         decoding="async">
</div>

<!-- Amsterdam section with optimized loading -->
<div class="amsterdam-layout" id="amsterdam-gallery">
    <div class="amsterdam-first-column">
        <img src="Amsterdam/1.JPG" alt="Amsterdam 1" 
             loading="lazy" 
             decoding="async">
        <img src="Amsterdam/2.JPG" alt="Amsterdam 2" 
             loading="lazy" 
             decoding="async">
        <img src="Amsterdam/3.JPG" alt="Amsterdam 3" 
             loading="lazy" 
             decoding="async">
    </div>
    <img src="Amsterdam/4.JPG" alt="Amsterdam 4" 
         loading="lazy" 
         decoding="async">
    <img src="Amsterdam/5.JPG" alt="Amsterdam 5" 
         loading="lazy" 
         decoding="async">
</div>

<!-- Add this script at the end of your body tag -->
<script>
    // Optimize image loading
    document.addEventListener("DOMContentLoaded", function() {
        // Initialize Intersection Observer for lazy loading
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    if (!img.src && img.dataset.src) {
                        img.src = img.dataset.src;
                    }
                    observer.unobserve(img);
                }
            });
        }, {
            rootMargin: "50px 0px",
            threshold: 0.01
        });

        // Get all images that should be lazy loaded
        const lazyImages = document.querySelectorAll('img[loading="lazy"]');
        lazyImages.forEach(img => {
            imageObserver.observe(img);
        });

        // Prevent layout shifts while loading
        const images = document.querySelectorAll('img');
        images.forEach(img => {
            img.style.aspectRatio = '4/3';  // Adjust ratio based on your actual images
            img.decoding = 'async';
        });
    });

    // Cache images for faster subsequent loads
    if ('caches' in window) {
        caches.open('image-cache').then(cache => {
            // Cache first few images
            const imagesToCache = [
                'SB/1.JPG',
                'SB/2.JPG',
                'SB/3.JPG'
            ];
            cache.addAll(imagesToCache);
        });
    }

    // Existing lightbox code
    const images = Array.from(document.querySelectorAll("img"));
    const lightbox = document.getElementById("lightbox");
    const modalImg = document.getElementById("modal-img");
    let currentIndex = 0;

    // ... rest of your existing lightbox code ...
</script> 